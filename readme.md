# Unresticted File Upload Vulnerability

Many webapplications have a option of uploading files to the webserver be it images, PDF's, text files etc.
If not handled in the right manner these files can be a potential threat to the webserver.. An attacker could send a form data POST request with a typical filename or Multipurpose Internet Mail Extensions(MIME) and can cause Arbitrary Code Execution(ACE). <br><br>
The first step in many attacks is to get some code to the system to be attacked. Then the exploiter only needs to find a way to get the code executed. Using a file upload helps the attacker accomplish the first step.
To exploit this vulnerability we mostly use using ASP, ASPX, CFM, JSP, Perl or PHP files. The severity of attack can range from gaining reverse shells to complete system takeover.<br>

# Ways to prevent it:
<b>Web application should :</b>
1. check for threatening file extensions like .asp, .php etc. before uploading it to server.<br>
2. check for files with double extensions for eg. apple.png.php.<br>
3. rename files before uploading it to the server.<br>
4. change the permissions on the upload folder so the files within it are not executable.
5. check for files without a name like .htaccess.<br>

# Let's try it!
Ok now lets make this article a little interesting! What about exploiting a file upload vulnerability ?

To follow up with the article make sure you are equipped with OWASP Broken Web Applications project. (Incase you don't have that <a href='https://www.codementor.io/@jayadityagupta/setting-up-owasp-bwa-with-virtualbox-a1wgz26vq'>this</a> guide can help you )

1.  Make sure the OWASP BWA is running then head over to it's webpage. Then click the encircled link to go to the bricks webpage.
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/brick.PNG)

2.  After that click the encircled option under 'Bricks' menu
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/brick2.png)

3.  Click the first option to proceed to the file upload page
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/1.PNG)

4.  Now we can easily upload our code to the web server.<br>
    So we will be uploading a php file <code>php-backdoor.php</code>(present in the repository) to obtain a webshell to the server. This file is extracted from Kali Linux     and can be found in <i>/usr/share/webshells/php</i> folder. You can also use other codes present there also but for the sake of this         article let's just stick to <b>php-backdoor.php</b>

    Now from choose file option upload the php-backdoor.php file to the web app. 
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/upload.PNG)

